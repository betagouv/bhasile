import { Repartition } from "@/types/adresse.type";
import { StructureType } from "@/types/structure.type";

import { TestStructureScenario } from "./types";

/**
 * CAES 2: Mixte, multiple addresses with repartition, one contact, mixed docs (one at finalisation),
 * with controls, full finances
 */
export const caes2: TestStructureScenario = {
  name: "CAES 2 - Mixte, multiple addresses with repartition, one contact, mixed docs, controls",
  formData: {
    dnaCode: "C1234",
    type: StructureType.CAES,
    cpom: false,
    operateur: {
      name: "Opérateur 1",
      searchTerm: "Opér",
      id: 1,
    },
    creationDate: "2015-06-01",
    public: "Tout public",
    lgbt: true,
    fvvTeh: true,
    contactPrincipal: {
      prenom: "John",
      nom: "Doe",
      role: "Directeur·rice",
      email: "john.doe@example.com",
      telephone: "+33123456789",
    },
    debutConvention: "2020-01-01",
    finConvention: "2023-12-31",
    nom: "Structure Test",
    adresseAdministrative: {
      complete: "1 Rue de la Paix 75001 Paris",
      searchTerm: "1 Rue de la Paix 75001 Paris",
    },
    departementAdministratif: "75",
    typeBati: Repartition.MIXTE,
    sameAddress: false,
    adresses: [
      {
        adresseComplete: "1 Rue de la Paix 75001 Paris",
        searchTerm: "1 Rue de la Paix 75001 Paris",
        placesAutorisees: 50,
        repartition: Repartition.DIFFUS,
      },
      {
        adresseComplete: "2 Rue de la Paix 75001 Paris",
        searchTerm: "2 Rue de la Paix 75001 Paris",
        placesAutorisees: 150,
        repartition: Repartition.COLLECTIF,
      },
    ],
    structureTypologies: [
      { placesAutorisees: 50, pmr: 5, lgbt: 10, fvvTeh: 8 },
      { placesAutorisees: 48, pmr: 5, lgbt: 10, fvvTeh: 8 },
      { placesAutorisees: 45, pmr: 4, lgbt: 8, fvvTeh: 7 },
    ],
    documentsFinanciers: {
      allAddedViaAjout: false,
      fileUploads: [
        {
          year: "2023",
          category: "Demande de subvention",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "ajout",
        },
        {
          year: "2023",
          category: "Compte-rendu financier",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2023",
          category: "Rapport d'activité de l'opérateur",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2022",
          category: "Demande de subvention",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2022",
          category: "Compte-rendu financier",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2022",
          category: "Rapport d'activité de l'opérateur",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2021",
          category: "Demande de subvention",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2021",
          category: "Compte-rendu financier",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
        {
          year: "2021",
          category: "Rapport d'activité de l'opérateur",
          fileName: "sample.csv",
          filePath: "tests/e2e/fixtures/sample.csv",
          formKind: "finalisation",
        },
      ],
    },
    finances: {
      2025: {
        ETP: "8",
        tauxEncadrement: "12,5",
        coutJournalier: "23,75",
        dotationDemandee: "120000",
        dotationAccordee: "110000",
      },
      2024: {
        ETP: 9,
        tauxEncadrement: 11.25,
        coutJournalier: 49.9,
        dotationDemandee: "9999999",
        dotationAccordee: "9500000",
        totalProduitsProposes: "1234567,89",
        totalProduits: "1234500",
        totalChargesProposees: "1100000",
        totalCharges: "1099999,5",
        repriseEtat: "0",
        affectationReservesFondsDedies: "2500",
        reserveInvestissement: "1000",
        chargesNonReconductibles: "150,5",
        reserveCompensationDeficits: "250",
        reserveCompensationBFR: "75",
        reserveCompensationAmortissements: "50",
        reportANouveau: "500",
        autre: "25",
      },
      2023: {
        ETP: "10",
        tauxEncadrement: "9,8",
        coutJournalier: 60.25,
        dotationDemandee: "250000",
        dotationAccordee: "249999,99",
        totalProduitsProposes: "300000",
        totalProduits: "299000,1",
        totalChargesProposees: "280000",
        totalCharges: "279999,99",
        repriseEtat: "-1500",
        excedentRecupere: "0",
        excedentDeduit: "0",
        affectationReservesFondsDedies: "0",
        fondsDedies: "0",
      },
      2022: {
        ETP: 7,
        tauxEncadrement: "10",
        coutJournalier: "0,5",
        dotationDemandee: "12345",
        dotationAccordee: "12000",
        totalProduitsProposes: "45000",
        totalProduits: "44000",
        totalChargesProposees: "43000",
        totalCharges: "42000",
        repriseEtat: "100",
        excedentRecupere: "10",
        excedentDeduit: "5",
        affectationReservesFondsDedies: "200",
        fondsDedies: "15",
        reserveInvestissement: "20",
        chargesNonReconductibles: "30",
        reserveCompensationDeficits: "40",
        reserveCompensationBFR: "50",
        reserveCompensationAmortissements: "60",
        reportANouveau: "70",
        autre: "80",
      },
      2021: {
        ETP: "3",
        tauxEncadrement: "2,75",
        coutJournalier: "1500",
        dotationDemandee: "1",
        dotationAccordee: "1",
        totalProduitsProposes: "2",
        totalProduits: "2",
        totalChargesProposees: "1",
        totalCharges: "1",
        repriseEtat: "0",
        excedentRecupere: "0",
        excedentDeduit: "0",
        affectationReservesFondsDedies: "1",
        fondsDedies: "0",
        reserveInvestissement: "0",
        chargesNonReconductibles: "0",
        reserveCompensationDeficits: "0",
        reserveCompensationBFR: "0",
        reserveCompensationAmortissements: "0",
        reportANouveau: "0",
        autre: "0",
      },
    },
    controles: [
      {
        date: "2022-11-05",
        type: "Programmé",
        filePath: "tests/e2e/fixtures/sample.csv",
      },
    ],
    ouvertureFermeture: {
      placesACreer: "4",
      echeancePlacesACreer: "2025-09-01",
      placesAFermer: "1",
      echeancePlacesAFermer: "2025-11-15",
    },
    actesAdministratifs: [
      {
        category: "CONVENTION",
        startDate: "2020-01-01",
        endDate: "2023-12-31",
        filePath: "tests/e2e/fixtures/sample.csv",
      },
    ],
    finalisationNotes:
      "Notes de finalisation dynamiques (CAES) : contrôle OK, suivi actif.",
  },
  modificationData: {
    public: "Tout public",
    lgbt: true,
    fvvTeh: false,
    contactPrincipal: { email: "modif-caes2@example.com" },
    notes: "Notes modification CAES 2 - mixte.",
    debutConvention: "2020-06-01",
    finConvention: "2024-12-31",
    ouvertureFermeture: {
      placesACreer: "7",
      echeancePlacesACreer: "2026-06-01",
      placesAFermer: "1",
      echeancePlacesAFermer: "2026-09-01",
    },
    structureTypologies: [
      { placesAutorisees: 52, pmr: 6, lgbt: 11, fvvTeh: 9 },
      { placesAutorisees: 50, pmr: 6, lgbt: 11, fvvTeh: 9 },
      { placesAutorisees: 47, pmr: 5, lgbt: 9, fvvTeh: 8 },
    ],
    finances: {
      2025: {
        ETP: "10",
        tauxEncadrement: "10",
        coutJournalier: "26",
        dotationDemandee: "128000",
        dotationAccordee: "120000",
      },
    },
    controles: [
      {
        date: "2024-03-10",
        type: "Programmé",
        filePath: "tests/e2e/fixtures/sample.csv",
      },
    ],
    actesAdministratifs: [
      {
        category: "AUTRE",
        categoryName: "PPI modification e2e",
        filePath: "tests/e2e/fixtures/sample.csv",
      },
    ],
  },
};
