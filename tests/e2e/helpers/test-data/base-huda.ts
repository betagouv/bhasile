import { Repartition } from "@/types/adresse.type";
import { StructureType } from "@/types/structure.type";

import { TestStructureData } from "./types";

/**
 * Base HUDA test data with all common fields
 * HUDA is a subventionnée structure - requires convention dates, no FINESS, no periode autorisation
 */
export const baseHudaData: Omit<TestStructureData, "dnaCode"> = {
  type: StructureType.HUDA,
  cpom: false,
  operateur: {
    name: "Opérateur Test",
    searchTerm: "Opér",
  },
  creationDate: "2015-06-01",
  // No FINESS code for subventionnée
  finessCode: undefined,
  public: "Tout public",
  lgbt: true,
  fvvTeh: true,
  contactPrincipal: {
    prenom: "John",
    nom: "Doe",
    role: "Directeur·rice",
    email: "john.doe@example.com",
    telephone: "+33123456789",
  },
  contactSecondaire: {
    prenom: "Jane",
    nom: "Deo",
    role: "Responsable administratif",
    email: "jane.deo@example.com",
    telephone: "+33623456789",
  },
  // No periode autorisation for subventionnée
  debutPeriodeAutorisation: undefined,
  finPeriodeAutorisation: undefined,
  // Convention dates required for subventionnée
  debutConvention: "2020-01-01",
  finConvention: "2023-12-31",
  nom: "Structure Test",
  adresseAdministrative: {
    complete: "1 Rue de la Paix 75001 Paris",
    searchTerm: "1 Rue de la Paix 75001 Paris",
  },
  departementAdministratif: "75",
  typeBati: Repartition.DIFFUS,
  sameAddress: false,
  adresses: [
    {
      adresseComplete: "1 Rue de la Paix 75001 Paris",
      searchTerm: "1 Rue de la Paix 75001 Paris",
      placesAutorisees: 50,
    },
    {
      adresseComplete: "2 Rue de la Paix 75001 Paris",
      searchTerm: "2 Rue de la Paix 75001 Paris",
      placesAutorisees: 150,
    },
  ],
  structureTypologies: [
    { placesAutorisees: 50, pmr: 5, lgbt: 10, fvvTeh: 8 },
    { placesAutorisees: 48, pmr: 5, lgbt: 10, fvvTeh: 8 },
    { placesAutorisees: 45, pmr: 4, lgbt: 8, fvvTeh: 7 },
  ],
  documentsFinanciers: {
    allAddedViaAjout: true,
    files: [
      // Subventionnée structures have different required documents
      // 2025
      { year: "2025", category: "Budget prévisionnel demandé", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2025", category: "Budget prévisionnel retenu (ou exécutoire)", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      // 2024
      { year: "2024", category: "Budget prévisionnel demandé", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2024", category: "Budget prévisionnel retenu (ou exécutoire)", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2024", category: "Compte administratif soumis", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2024", category: "Rapport d'activité", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      // 2023
      { year: "2023", category: "Budget prévisionnel demandé", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2023", category: "Budget prévisionnel retenu (ou exécutoire)", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2023", category: "Compte administratif soumis", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2023", category: "Rapport d'activité", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2023", category: "Compte administratif retenu", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      // 2022
      { year: "2022", category: "Budget prévisionnel demandé", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2022", category: "Budget prévisionnel retenu (ou exécutoire)", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2022", category: "Compte administratif soumis", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2022", category: "Rapport d'activité", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2022", category: "Compte administratif retenu", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      // 2021
      { year: "2021", category: "Budget prévisionnel demandé", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2021", category: "Budget prévisionnel retenu (ou exécutoire)", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2021", category: "Compte administratif soumis", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2021", category: "Rapport d'activité", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
      { year: "2021", category: "Compte administratif retenu", fileName: "sample.csv", filePath: "tests/e2e/fixtures/sample.csv", formKind: "ajout" },
    ],
  },
  finances: {
    2025: {
      ETP: "8",
      tauxEncadrement: "12,5",
      coutJournalier: "23,75",
      dotationDemandee: "120000",
      dotationAccordee: "110000",
    },
    2024: {
      ETP: 9,
      tauxEncadrement: 11.25,
      coutJournalier: 49.9,
      dotationDemandee: "9999999",
      dotationAccordee: "9500000",
      totalProduitsProposes: "1234567,89",
      totalProduits: "1234500",
      totalChargesProposees: "1100000",
      totalCharges: "1099999,5",
      repriseEtat: "0",
      affectationReservesFondsDedies: "2500",
      reserveInvestissement: "1000",
      chargesNonReconductibles: "150,5",
      reserveCompensationDeficits: "250",
      reserveCompensationBFR: "75",
      reserveCompensationAmortissements: "50",
      reportANouveau: "500",
      autre: "25",
    },
    2023: {
      ETP: "10",
      tauxEncadrement: "9,8",
      coutJournalier: 60.25,
      dotationDemandee: "250000",
      dotationAccordee: "249999,99",
      totalProduitsProposes: "300000",
      totalProduits: "299000,1",
      totalChargesProposees: "280000",
      totalCharges: "279999,99",
      repriseEtat: "-1500",
      excedentRecupere: "0",
      excedentDeduit: "0",
      affectationReservesFondsDedies: "0",
      fondsDedies: "0",
    },
    2022: {
      ETP: 7,
      tauxEncadrement: "10",
      coutJournalier: "0,5",
      dotationDemandee: "12345",
      dotationAccordee: "12000",
      totalProduitsProposes: "45000",
      totalProduits: "44000",
      totalChargesProposees: "43000",
      totalCharges: "42000",
      repriseEtat: "100",
      excedentRecupere: "10",
      excedentDeduit: "-5",
      affectationReservesFondsDedies: "200",
      fondsDedies: "15",
      reserveInvestissement: "20",
      chargesNonReconductibles: "30",
      reserveCompensationDeficits: "40",
      reserveCompensationBFR: "50",
      reserveCompensationAmortissements: "60",
      reportANouveau: "70",
      autre: "80",
    },
    2021: {
      ETP: "3",
      tauxEncadrement: "2,75",
      coutJournalier: "1500",
      dotationDemandee: "1",
      dotationAccordee: "1",
      totalProduitsProposes: "2",
      totalProduits: "2",
      totalChargesProposees: "1",
      totalCharges: "1",
      repriseEtat: "0",
      excedentRecupere: "0",
      excedentDeduit: "0",
      affectationReservesFondsDedies: "1",
      fondsDedies: "0",
      reserveInvestissement: "0",
      chargesNonReconductibles: "0",
      reserveCompensationDeficits: "0",
      reserveCompensationBFR: "0",
      reserveCompensationAmortissements: "0",
      reportANouveau: "0",
      autre: "0",
    },
  },
  // TODO: remove evaluation (not required for subventionnée)
  evaluations: [
    { date: "2021-05-12", filePath: "tests/e2e/fixtures/sample.csv" },
  ],
  controles: [
    { date: "2022-11-05", type: "Programmé", filePath: "tests/e2e/fixtures/sample.csv" },
    { date: "2024-03-14", type: "Inopiné", filePath: "tests/e2e/fixtures/sample.csv" },
  ],
  ouvertureFermeture: {
    placesACreer: "4",
    echeancePlacesACreer: "2025-09-01",
    placesAFermer: "1",
    echeancePlacesAFermer: "2025-11-15",
  },
  actesAdministratifs: [
    { category: "CONVENTION", startDate: "2020-01-01", endDate: "2023-12-31", filePath: "tests/e2e/fixtures/sample.csv" },
    { category: "AUTRE", categoryName: "Document e2e", filePath: "tests/e2e/fixtures/sample.csv" },
  ],
  finalisationNotes: "Notes de finalisation dynamiques (HUDA) : contrôle OK, suivi actif.",
};
